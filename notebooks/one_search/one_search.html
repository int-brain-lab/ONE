<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Searching with ONE &mdash; ONE  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Listing with ONE" href="../one_list/one_list.html" />
    <link rel="prev" title="ONE Quick Start" href="../one_quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ONE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Using ONE to access data</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../one_reference.html">Introduction to ONE (Open Neurophysiology Environment)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../one_installation.html">ONE installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Searching with ONE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Searching-insertions">Searching insertions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../one_list/one_list.html">Listing with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../one_load/one_load.html">Loading with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_ids.html">Experiment IDs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using ONE with Alyx</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../one_modes.html">ONE API modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../one_advanced/one_advanced.html">ONE REST queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_alyx_queries.html">Useful Alyx REST queries</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using ONE to share data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data_sharing.html">Releasing data with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recording_data_access.html">Recording Data Access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ALF</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../alf_intro.html">ALyx Filenames (ALF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alyx_files.html">Listing Alyx Filenames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets_and_types.html">Datasets and their types</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ONE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Searching with ONE</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/one_search/one_search.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <a href="one_search.ipynb"><button id="download">Download tutorial notebook</button></a>
<a href="https://github.com/int-brain-lab/ONE/tree/main/docs/notebooks/one_search/
one_search.ipynb"><button id="github">Github link</button></a><section id="Searching-with-ONE">
<h1>Searching with ONE<a class="headerlink" href="#Searching-with-ONE" title="Permalink to this heading"></a></h1>
<p>ONE contains a method that allows you to search for sessions of interest. The possible search terms can be listed using,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">one.api</span> <span class="kn">import</span> <span class="n">ONE</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">ONE</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span><span class="s1">&#39;https://openalyx.internationalbrainlab.org&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">one</span><span class="o">.</span><span class="n">search_terms</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;dataset&#39;, &#39;date_range&#39;, &#39;laboratory&#39;, &#39;number&#39;, &#39;project&#39;, &#39;subject&#39;, &#39;task_protocol&#39;)
</pre></div></div>
</div>
<p>We can search for sessions within a specified date range</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="n">eids</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">date_range</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-01-01&#39;</span><span class="p">])</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">eids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;4ecb5d24-f5cc-402c-be28-9d0f7cb14b3a&#39;,
 &#39;c7bd79c9-c47e-4ea5-aea3-74dda991b48e&#39;,
 &#39;4b7fbad4-f6de-43b4-9b15-c7c7ef44db4b&#39;]
</pre></div></div>
</div>
<p>To get more information about the sessions we can add a details=True flag</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eids</span><span class="p">,</span> <span class="n">details</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">date_range</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-01-01&#39;</span><span class="p">],</span> <span class="n">details</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">details</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([&#39;4ecb5d24-f5cc-402c-be28-9d0f7cb14b3a&#39;,
  &#39;c7bd79c9-c47e-4ea5-aea3-74dda991b48e&#39;,
  &#39;4b7fbad4-f6de-43b4-9b15-c7c7ef44db4b&#39;],
 [{&#39;date&#39;: datetime.date(2020, 9, 21),
   &#39;lab&#39;: &#39;hoferlab&#39;,
   &#39;number&#39;: 1,
   &#39;project&#39;: &#39;ibl_neuropixel_brainwide_01&#39;,
   &#39;subject&#39;: &#39;SWC_043&#39;,
   &#39;task_protocol&#39;: &#39;_iblrig_tasks_ephysChoiceWorld6.4.2&#39;},
  {&#39;date&#39;: datetime.date(2020, 9, 19),
   &#39;lab&#39;: &#39;zadorlab&#39;,
   &#39;number&#39;: 1,
   &#39;project&#39;: &#39;ibl_neuropixel_brainwide_01&#39;,
   &#39;subject&#39;: &#39;CSH_ZAD_029&#39;,
   &#39;task_protocol&#39;: &#39;_iblrig_tasks_ephysChoiceWorld6.4.2&#39;},
  {&#39;date&#39;: datetime.date(2020, 1, 8),
   &#39;lab&#39;: &#39;churchlandlab&#39;,
   &#39;number&#39;: 1,
   &#39;project&#39;: &#39;ibl_neuropixel_brainwide_01&#39;,
   &#39;subject&#39;: &#39;CSHL049&#39;,
   &#39;task_protocol&#39;: &#39;_iblrig_tasks_ephysChoiceWorld6.2.5&#39;}])
</pre></div></div>
</div>
<p>Multiple search terms can also be combined, for example we can search for any sessions from the subject SWC_043 that contain the datasets spikes.times and spikes.clusters</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eids</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="s1">&#39;SWC_043&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spikes.times&#39;</span><span class="p">,</span> <span class="s1">&#39;spikes.clusters&#39;</span><span class="p">])</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">eids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;4ecb5d24-f5cc-402c-be28-9d0f7cb14b3a&#39;]
</pre></div></div>
</div>
<p>More search terms are available when making <a class="reference external" href="../one_modes.html">remote queries</a> (using the remote Alyx database instead of the local cache). You can view all the remote search terms with the ‘remote’ arg:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one</span><span class="o">.</span><span class="n">search_terms</span><span class="p">(</span><span class="s1">&#39;remote&#39;</span><span class="p">)</span>
<span class="n">eids</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">performance_gte</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;remote&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To find out more information about the <code class="docutils literal notranslate"><span class="pre">one.search</span></code> method we can use the help function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">one</span><span class="o">.</span><span class="n">search</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method search in module one.api:

search(details=False, query_type=None, **kwargs) method of one.api.OneAlyx instance
    Searches sessions matching the given criteria and returns a list of matching eids

    For a list of search terms, use the method

     one.search_terms(query_type=&#39;remote&#39;)

    For all of the search parameters, a single value or list may be provided.  For dataset,
    the sessions returned will contain all listed datasets.  For the other parameters,
    the session must contain at least one of the entries. NB: Wildcards are not permitted,
    however if wildcards property is False, regular expressions may be used for all but
    number and date_range.

    Parameters
    ----------
    dataset : str, list
        list of dataset names. Returns sessions containing all these datasets.
        A dataset matches if it contains the search string e.g. &#39;wheel.position&#39; matches
        &#39;_ibl_wheel.position.npy&#39;
    date_range : str, list, datetime.datetime, datetime.date, pandas.timestamp
        A single date to search or a list of 2 dates that define the range (inclusive).  To
        define only the upper or lower date bound, set the other element to None.
    lab : str, list
        A str or list of lab names, returns sessions from any of these labs
    number : str, int
        Number of session to be returned, i.e. number in sequence for a given date
    subject : str, list
        A list of subject nicknames, returns sessions for any of these subjects
    task_protocol : str, list
        The task protocol name (can be partial, i.e. any task protocol containing that str
        will be found)
    project : str, list
        The project name (can be partial, i.e. any task protocol containing that str
        will be found)
    performance_lte / performance_gte : float
        search only for sessions whose performance is less equal or greater equal than a
        pre-defined threshold as a percentage (0-100)
    users : str, list
        A list of users
    location : str, list
        a str or list of lab location (as per Alyx definition) name
        Note: this corresponds to the specific rig, not the lab geographical location per se
    dataset_types : str, list
        One or more of dataset_types
    details : bool
        If true also returns a dict of dataset details
    query_type : str, None
        Query cache (&#39;local&#39;) or Alyx database (&#39;remote&#39;)
    limit : int
        The number of results to fetch in one go (if pagination enabled on server)

    Returns
    -------
    List of eids and, if details is True, also returns a list of dictionaries, each entry
    corresponding to a matching session

</pre></div></div>
</div>
<section id="Searching-insertions">
<h2>Searching insertions<a class="headerlink" href="#Searching-insertions" title="Permalink to this heading"></a></h2>
<p>A session may contain multiple insertions recording different brain areas. To find data associated with a specific brain area, it is useful to search by insertion instead of by session.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">OneAlyx.search_insertions</span></code> method takes similar arguments to the remote search method, and returns a list of probe UUIDs (pIDs), which can be interconverted with session IDs (eIDs) for <a class="reference external" href="../one_load/one_load.html#Load-spike-times-from-a-probe-UUID">loading data</a>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note.</p>
<p>The search_insertions method is only available in <a class="reference external" href="../one_modes">remote mode</a>.</p>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one</span><span class="o">.</span><span class="n">search_terms</span><span class="p">(</span><span class="s1">&#39;remote&#39;</span><span class="p">,</span> <span class="s1">&#39;insertions&#39;</span><span class="p">)</span>
<span class="n">pids</span> <span class="o">=</span> <span class="n">one</span><span class="o">.</span><span class="n">search_insertions</span><span class="p">(</span><span class="n">atlas_acronym</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STR&#39;</span><span class="p">,</span> <span class="s1">&#39;CA3&#39;</span><span class="p">],</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;remote&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../one_quickstart.html" class="btn btn-neutral float-left" title="ONE Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../one_list/one_list.html" class="btn btn-neutral float-right" title="Listing with ONE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, International Brain Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>