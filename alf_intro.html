

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>ALyx Files (ALF) &mdash; ONE  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api_reference.html" />
    <link rel="prev" title="Alyx Files (ALF)" href="alf.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ONE
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="one.html">ONE</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="alf.html">Alyx Files (ALF)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ALyx Files (ALF)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#optional-components">Optional components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#collections">Collections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#revisions">Revisions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#namespace">Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timescale">Timescale</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extension">Extension</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extra">Extra</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relations">Relations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#glossary">Glossary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataset-name">Dataset name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataset-type">Dataset type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#session-path">Session path</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relative-path">Relative path</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alf-path">ALF path</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ONE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="alf.html">Alyx Files (ALF)</a> &raquo;</li>
        
      <li>ALyx Files (ALF)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/alf_intro.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="tex2jax_ignore mathjax_ignore section" id="alyx-files-alf">
<h1>ALyx Files (ALF)<a class="headerlink" href="#alyx-files-alf" title="Permalink to this headline">¶</a></h1>
<p>This package is concerned with parsing and loading files that follow the Alyx file name specification.
Files should be organized in folders by subject name, date and session number, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span>
</pre></div>
</div>
<p>Optionally the lab may also be present in the folder structure, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lab_name</span><span class="o">/</span><span class="n">Subjects</span><span class="o">/</span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span>
</pre></div>
</div>
<p>The file names themselves should have at least two components; an object and attribute, separated by a period.
For example a file called <code class="docutils literal notranslate"><span class="pre">trials.intervals</span></code> represents the trials object with an intervals attribute.
The full file path would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lab_name</span><span class="o">/</span><span class="n">Subjects</span><span class="o">/</span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="n">trials</span><span class="o">.</span><span class="n">intervals</span>
</pre></div>
</div>
<p>Objects and attributes should be in Haskell case for example <code class="docutils literal notranslate"><span class="pre">sparseNoise.xyPos</span></code> but supports
acronyms, e.g. <code class="docutils literal notranslate"><span class="pre">RFMapStim.intervals</span></code>, <code class="docutils literal notranslate"><span class="pre">ROIMotionEnergy.position</span></code>.  Underscores, hyphens and spaces are
not supported, except with ‘times’, ‘timestamps’ and ‘intervals’, which have a special meaning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">goCue_times</span>
</pre></div>
</div>
<div class="section" id="optional-components">
<h2>Optional components<a class="headerlink" href="#optional-components" title="Permalink to this headline">¶</a></h2>
<p>There are other optional parts to the file path that are used to convey other information.</p>
<div class="section" id="collections">
<h3>Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<p>Within a session folder the data may be placed in any number of sub-folders, each one is referred to as a
collection and these may be used to sort identical datasets by device or preprocessing software.  For
example spikes collected on two different probes maybe in different numbered probe collections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="n">probe00</span><span class="o">/</span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
<span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="n">probe01</span><span class="o">/</span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
</pre></div>
</div>
<p>Perhaps for analysis the spikes were sorted using two different spike sorters, one with Kilosort, the
other with Yass:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="n">probe00</span><span class="o">/</span><span class="n">ks2</span><span class="mf">.1</span><span class="o">/</span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
<span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="n">probe01</span><span class="o">/</span><span class="n">yass</span><span class="o">/</span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
</pre></div>
</div>
</div>
<div class="section" id="revisions">
<h3>Revisions<a class="headerlink" href="#revisions" title="Permalink to this headline">¶</a></h3>
<p>If the data require pre-processing in a different manner, a revision folder may be used so that the
original data is not overwritten.  This can be used as a form of versioning and should be a dated
folder surrounded by pound signs, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="c1">#2021-06-01#/spikes.times.npy</span>
</pre></div>
</div>
<p>Unlike collections these can be searched in lexicographical order such that a users can load a revision
before or after a certain date.  If multiple revisions exist for a given date, letters may be appended
to preserve ordering:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="c1">#2021-06-01#/spikes.times.npy</span>
<span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="c1">#2021-06-01a#/spikes.times.npy</span>
<span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span><span class="o">/</span><span class="c1">#2021-06-01b#/spikes.times.npy</span>
</pre></div>
</div>
</div>
<div class="section" id="namespace">
<h3>Namespace<a class="headerlink" href="#namespace" title="Permalink to this headline">¶</a></h3>
<p>For datasets that are not intended to be standard in the community, a namespace may be added to the
start of the filename.  This must be surrounded by underscores:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_ibl_wheel</span><span class="o">.</span><span class="n">position</span>
<span class="n">_ss_gratingID</span><span class="o">.</span><span class="n">laserOn</span><span class="o">.</span><span class="n">npy</span>
</pre></div>
</div>
</div>
<div class="section" id="timescale">
<h3>Timescale<a class="headerlink" href="#timescale" title="Permalink to this headline">¶</a></h3>
<p>Datasets containing timestamp data are expected to be in the same common timescale (usually seconds from
experiment start).  For datasets in a different timescale, the clock name should be appended to the
attribute part with an underscore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spikes</span><span class="o">.</span><span class="n">times_ephysClock</span><span class="o">.</span><span class="n">npy</span>
<span class="n">trials</span><span class="o">.</span><span class="n">intervals_bpod</span><span class="o">.</span><span class="n">ssv</span>
</pre></div>
</div>
</div>
<div class="section" id="extension">
<h3>Extension<a class="headerlink" href="#extension" title="Permalink to this headline">¶</a></h3>
<p>The extension should be self-explanatory.  Although they are optional in the ALF spec, it’s preferable
to include the format in the filename, and to use formats that are well supported in MATLAB and Python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
<span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">csv</span>
<span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">mat</span>
</pre></div>
</div>
</div>
<div class="section" id="extra">
<h3>Extra<a class="headerlink" href="#extra" title="Permalink to this headline">¶</a></h3>
<p>Any number of extra parts, separated by periods, can be added after the attribute.  Examples include UUIDs
for ensuring the filename is unique or parts for splitting datasets into parts.  NB: The text after the final
period is expected to be the file extension.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">intervals</span><span class="mf">.9198</span><span class="n">edcd</span><span class="o">-</span><span class="n">e8a4</span><span class="o">-</span><span class="mf">4e8</span><span class="n">a</span><span class="o">-</span><span class="mi">994</span><span class="n">f</span><span class="o">-</span><span class="n">d68a2e300380</span><span class="o">.</span><span class="n">npy</span>
<span class="mi">2</span><span class="n">p</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">part01</span><span class="o">.</span><span class="n">tiff</span>
<span class="mi">2</span><span class="n">p</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">part02</span><span class="o">.</span><span class="n">tiff</span>
</pre></div>
</div>
</div>
<div class="section" id="relations">
<h3>Relations<a class="headerlink" href="#relations" title="Permalink to this headline">¶</a></h3>
<p>Alf objects can be related through their attributes. If the attribute name of one file matches the object name of a
second, then the first file is guaranteed to contain integers referring to the rows of the second. For example,
spikes.clusters.npy would contain integer references to the rows of clusters.brain_location.json and
clusters.probes.npy; and clusters.probes.npy would contain integer references to probes.insertion.json.</p>
</div>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dataset-name">
<h3>Dataset name<a class="headerlink" href="#dataset-name" title="Permalink to this headline">¶</a></h3>
<p>A filename with at least an object and attribute.  Some examples of valid ALF datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span>
<span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
<span class="n">_ibl_trials</span><span class="o">.</span><span class="n">goCue_times_bpodClock</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
</div>
<div class="section" id="dataset-type">
<h3>Dataset type<a class="headerlink" href="#dataset-type" title="Permalink to this headline">¶</a></h3>
<p>In Alyx datasets are grouped by a type.  Datasets should belong to exactly one dataset type.  The
group is determined by a filename pattern.  Dataset types group datasets with the same content but
different formats, etc. and include a description of the dataset.  For example, the following datasets
belong to the ‘<em>spikes.times</em>’ dataset type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span>
<span class="n">_spikeglx_spikes</span><span class="o">.</span><span class="n">times_ephysClock</span><span class="o">.</span><span class="n">npy</span>
<span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="mf">.9198</span><span class="n">edcd</span><span class="o">-</span><span class="n">e8a4</span><span class="o">-</span><span class="mf">4e8</span><span class="n">a</span><span class="o">-</span><span class="mi">994</span><span class="n">f</span><span class="o">-</span><span class="n">d68a2e300380</span><span class="o">.</span><span class="n">npy</span>
<span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">cbin</span>
</pre></div>
</div>
</div>
<div class="section" id="session-path">
<h3>Session path<a class="headerlink" href="#session-path" title="Permalink to this headline">¶</a></h3>
<p>The part of the path that includes the subject name, date and number.  Optionally a lab name may also
be part of the session path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">001</span>
<span class="n">cortexlab</span><span class="o">/</span><span class="n">Subjects</span><span class="o">/</span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="relative-path">
<h3>Relative path<a class="headerlink" href="#relative-path" title="Permalink to this headline">¶</a></h3>
<p>Everything that comes after the session path.  In other words the filename and optional collections
and revision folders:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alf</span><span class="o">/</span><span class="n">probe00</span><span class="o">/</span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
<span class="n">trials</span><span class="o">.</span><span class="n">intervals</span><span class="o">.</span><span class="n">npy</span>
<span class="c1">#2021-06-01#/trials.intervals.npy</span>
</pre></div>
</div>
</div>
<div class="section" id="alf-path">
<h3>ALF path<a class="headerlink" href="#alf-path" title="Permalink to this headline">¶</a></h3>
<p>The full file path, including the session path and relative path, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cortexlab</span><span class="o">/</span><span class="n">Subjects</span><span class="o">/</span><span class="n">mouse_001</span><span class="o">/</span><span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">27</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">alf</span><span class="o">/</span><span class="n">probe00</span><span class="o">/</span><span class="n">spikes</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">npy</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api_reference.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="alf.html" class="btn btn-neutral float-left" title="Alyx Files (ALF)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, International Brain Lab.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>