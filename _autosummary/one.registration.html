

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>one.registration &mdash; ONE  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/style.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="one.remote" href="one.remote.html" />
    <link rel="prev" title="one.params.CACHE_DIR_DEFAULT" href="one.params.CACHE_DIR_DEFAULT.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ONE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Using ONE to access data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../one_reference.html">Introduction to ONE (Open Neurophysiology Environment)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../one_installation.html">ONE installation and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/one_search/one_search.html">Searching with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/one_list/one_list.html">Listing with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/one_load/one_load.html">Loading with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/experiment_ids.html">Experiment IDs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using ONE with Alyx</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/one_modes.html">ONE API modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/one_advanced/one_advanced.html">ONE REST queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/useful_alyx_queries.html">Useful Alyx REST queries</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using ONE to share data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/data_sharing.html">Releasing data with ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/recording_data_access.html">Recording data access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ALF</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../alf_intro.html">ALyx Filenames (ALF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/alyx_files.html">Listing Alyx Filenames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/alf_paths.html">ALF Path objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/datasets_and_types.html">Datasets and their types</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="one.html">one</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="one.alf.html">one.alf</a></li>
<li class="toctree-l3"><a class="reference internal" href="one.api.html">one.api</a></li>
<li class="toctree-l3"><a class="reference internal" href="one.converters.html">one.converters</a></li>
<li class="toctree-l3"><a class="reference internal" href="one.params.html">one.params</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">one.registration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#summary-of-methods">Summary of methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#one.registration.get_dataset_type"><code class="docutils literal notranslate"><span class="pre">get_dataset_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#one.registration.RegistrationClient"><code class="docutils literal notranslate"><span class="pre">RegistrationClient</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="one.remote.html">one.remote</a></li>
<li class="toctree-l3"><a class="reference internal" href="one.tests.html">one.tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="one.util.html">one.util</a></li>
<li class="toctree-l3"><a class="reference internal" href="one.webclient.html">one.webclient</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ONE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api_reference.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="one.html">one</a></li>
      <li class="breadcrumb-item active">one.registration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/one.registration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-one.registration">
<span id="one-registration"></span><h1>one.registration<a class="headerlink" href="#module-one.registration" title="Link to this heading"></a></h1>
<p>Session creation and datasets registration.</p>
<p>The RegistrationClient provides an high-level API for creating experimentation sessions on Alyx
and registering associated datasets.</p>
<section id="summary-of-methods">
<h2>Summary of methods<a class="headerlink" href="#summary-of-methods" title="Link to this heading"></a></h2>
<p>create_new_session - Create a new local session folder and optionally create session record on Alyx
create_sessions - Create sessions and register files for folder containing a given flag file
register_session - Create a session on Alyx from local path and register any ALF datasets present
register_files - Register a list of files to their respective sessions on Alyx</p>
</section>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#one.registration.get_dataset_type" title="one.registration.get_dataset_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dataset_type</span></code></a></p></td>
<td><p>Get the dataset type from a given filename.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#one.registration.RegistrationClient" title="one.registration.RegistrationClient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RegistrationClient</span></code></a></p></td>
<td><p>Methods to create sessions and register data.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="one.registration.get_dataset_type">
<span class="sig-name descname"><span class="pre">get_dataset_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtypes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#get_dataset_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.get_dataset_type" title="Link to this definition"></a></dt>
<dd><p>Get the dataset type from a given filename.</p>
<p>A dataset type is matched one of two ways:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>the filename matches the dataset type filename_pattern;</p></li>
<li><p>if filename_pattern is empty, the filename object.attribute matches the dataset type name.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – The filename or filepath.</p></li>
<li><p><strong>dtypes</strong> (<em>iterable</em>) – An iterable of dataset type objects with the attributes (‘name’, ‘filename_pattern’).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The matching dataset type object for filename.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – filename doesn’t match any of the dataset types
    filename matches multiple dataset types</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="one.registration.RegistrationClient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RegistrationClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Methods to create sessions and register data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.create_sessions">
<span class="sig-name descname"><span class="pre">create_sessions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_data_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">glob_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'**/create_me.flag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">register_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.create_sessions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.create_sessions" title="Link to this definition"></a></dt>
<dd><p>Create sessions looking recursively for flag files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_data_folder</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – Folder to look for sessions.</p></li>
<li><p><strong>glob_pattern</strong> (<em>str</em>) – Register valid sessions that contain this pattern.</p></li>
<li><p><strong>register_files</strong> (<em>bool</em>) – If true, register all valid datasets within the session folder.</p></li>
<li><p><strong>dry</strong> (<em>bool</em>) – If true returns list of sessions without creating them on Alyx.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list of pathlib.Paths</em> – Newly created session paths.</p></li>
<li><p><em>list of dicts</em> – Alyx session records.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.create_new_session">
<span class="sig-name descname"><span class="pre">create_new_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">register</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.create_new_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.create_new_session" title="Link to this definition"></a></dt>
<dd><p>Create a new local session folder and optionally create session record on Alyx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject</strong> (<em>str</em>) – The subject name.  Must exist on Alyx.</p></li>
<li><p><strong>session_root</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – The root folder in which to create the subject/date/number folder.  Defaults to ONE
cache directory.</p></li>
<li><p><strong>date</strong> (<em>datetime.datetime</em><em>, </em><em>datetime.date</em><em>, </em><em>str</em>) – An optional date for the session.  If None the current time is used.</p></li>
<li><p><strong>register</strong> (<em>bool</em>) – If true, create session record on Alyx database.</p></li>
<li><p><strong>kwargs</strong> – Optional arguments for RegistrationClient.register_session.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pathlib.Path</em> – New local session path.</p></li>
<li><p><em>uuid.UUID</em> – The experiment UUID if register is True.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a local session only</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">session_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">RegistrationClient</span><span class="p">()</span><span class="o">.</span><span class="n">create_new_session</span><span class="p">(</span><span class="s1">&#39;Ian&#39;</span><span class="p">,</span> <span class="n">register</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Register a session on Alyx in a specific location</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">session_path</span><span class="p">,</span> <span class="n">eid</span> <span class="o">=</span> <span class="n">RegistrationClient</span><span class="p">()</span><span class="o">.</span><span class="n">create_new_session</span><span class="p">(</span><span class="s1">&#39;Sy&#39;</span><span class="p">,</span> <span class="s1">&#39;/data/lab/Subjects&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a session for a given date</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">session_path</span><span class="p">,</span> <span class="n">eid</span> <span class="o">=</span> <span class="n">RegistrationClient</span><span class="p">()</span><span class="o">.</span><span class="n">create_new_session</span><span class="p">(</span><span class="s1">&#39;Ian&#39;</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.find_files">
<span class="sig-name descname"><span class="pre">find_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.find_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.find_files" title="Link to this definition"></a></dt>
<dd><p>Returns a generator of file names that match one of the dataset type patterns in Alyx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>session_path</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – The session path to search.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pathlib.Path</em> – File paths that match the dataset type patterns in Alyx.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.assert_exists">
<span class="sig-name descname"><span class="pre">assert_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">member</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.assert_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.assert_exists" title="Link to this definition"></a></dt>
<dd><p>Raise an error if a given member doesn’t exist on Alyx database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>member</strong> (<em>str</em><em>, </em><em>uuid.UUID</em><em>, </em><em>list</em>) – The member ID(s) to verify</p></li>
<li><p><strong>endpoint</strong> (<em>str</em>) – The endpoint at which to look it up</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">assert_exists</span><span class="p">(</span><span class="s1">&#39;ALK_036&#39;</span><span class="p">,</span> <span class="s1">&#39;subjects&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">assert_exists</span><span class="p">(</span><span class="s1">&#39;user_45&#39;</span><span class="p">,</span> <span class="s1">&#39;users&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">assert_exists</span><span class="p">(</span><span class="s1">&#39;local_server&#39;</span><span class="p">,</span> <span class="s1">&#39;repositories&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="one.alf.exceptions.html#one.alf.exceptions.AlyxSubjectNotFound" title="one.alf.exceptions.AlyxSubjectNotFound"><strong>one.alf.exceptions.AlyxSubjectNotFound</strong></a> – Subject does not exist on Alyx</p></li>
<li><p><a class="reference internal" href="one.alf.exceptions.html#one.alf.exceptions.ALFError" title="one.alf.exceptions.ALFError"><strong>one.alf.exceptions.ALFError</strong></a> – Member does not exist on Alyx</p></li>
<li><p><strong>requests.exceptions.HTTPError</strong> – Failed to connect to Alyx database or endpoint not found</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The endpoint data if member exists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, list of dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.ensure_ISO8601">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensure_ISO8601</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.ensure_ISO8601"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.ensure_ISO8601" title="Link to this definition"></a></dt>
<dd><p>Ensure provided date is ISO 8601 compliant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>date</strong> (<em>str</em><em>, </em><em>None</em><em>, </em><em>datetime.date</em><em>, </em><em>datetime.datetime</em>) – An optional date to convert to ISO string.  If None, the current datetime is used.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The datetime as an ISO 8601 string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.register_session">
<span class="sig-name descname"><span class="pre">register_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ses_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">users</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.register_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.register_session" title="Link to this definition"></a></dt>
<dd><p>Register session in Alyx.</p>
<p>NB: If providing a lab or start_time kwarg, they must match the lab (if there is one)
and date of the session path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ses_path</strong> (<em>str</em><em>, </em><em>pathlib.Path</em>) – The local session path</p></li>
<li><p><strong>users</strong> (<em>str</em><em>, </em><em>list</em>) – The user(s) to attribute to the session</p></li>
<li><p><strong>file_list</strong> (<em>bool</em><em>, </em><em>list</em>) – An optional list of file paths to register.  If True, all valid files within the
session folder are registered.  If False, no files are registered</p></li>
<li><p><strong>location</strong> (<em>str</em>) – The optional location within the lab where the experiment takes place</p></li>
<li><p><strong>procedures</strong> (<em>str</em><em>, </em><em>list</em>) – An optional list of procedures, e.g. ‘Behavior training/tasks’</p></li>
<li><p><strong>n_correct_trials</strong> (<em>int</em>) – The number of correct trials (optional)</p></li>
<li><p><strong>n_trials</strong> (<em>int</em>) – The total number of completed trials (optional)</p></li>
<li><p><strong>json</strong> (<em>dict</em><em>, </em><em>str</em>) – Optional JSON data</p></li>
<li><p><strong>projects</strong> (<em>str</em><em>, </em><em>list</em>) – The project(s) to which the experiment belongs (optional)</p></li>
<li><p><strong>type</strong> (<em>str</em>) – The experiment type, e.g. ‘Experiment’, ‘Base’</p></li>
<li><p><strong>task_protocol</strong> (<em>str</em>) – The task protocol (optional)</p></li>
<li><p><strong>lab</strong> (<em>str</em>) – The name of the lab where the session took place.  If None the lab name will be
taken from the path.  If no lab name is found in the path (i.e. no &lt;lab&gt;/Subjects)
the default lab on Alyx will be used.</p></li>
<li><p><strong>start_time</strong> (<em>str</em><em>, </em><em>datetime.datetime</em>) – The precise start time of the session.  The date must match the date in the session
path.</p></li>
<li><p><strong>end_time</strong> (<em>str</em><em>, </em><em>datetime.datetime</em>) – The precise end time of the session.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>dict</em> – An Alyx session record</p></li>
<li><p><em>list, None</em> – Alyx file records (or None if file_list is False)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>AssertionError</strong> – Subject does not exist on Alyx or provided start_time does not match date in
    session path.</p></li>
<li><p><strong>ValueError</strong> – The provided lab name does not match the one found in the session path or
    start_time/end_time is not a valid ISO date time.</p></li>
<li><p><strong>requests.HTTPError</strong> – A 400 status code means the submitted data was incorrect (e.g. task_protocol was an
    int instead of a str); A 500 status code means there was a server error.</p></li>
<li><p><strong>ConnectionError</strong> – Failed to connect to Alyx, most likely due to a bad internet connection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.prepare_files">
<span class="sig-name descname"><span class="pre">prepare_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.prepare_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.prepare_files" title="Link to this definition"></a></dt>
<dd><p>Validate file list for registration and group files by session path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list</strong> (<em>list</em><em>, </em><em>str</em><em>, </em><em>pathlib.Path</em>) – A filepath (or list thereof) of ALF datasets to register to Alyx.</p></li>
<li><p><strong>versions</strong> (<em>str</em><em>, </em><em>list</em><em> of </em><em>str</em>) – Optional version tags.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list of dicts</em> – A dict containing a list of files for each session.</p></li>
<li><p><em>list of dicts</em> – A dict containing a list of versions for each session.</p></li>
<li><p><em>list</em> – A list of files converted to paths.</p></li>
<li><p><em>bool</em> – A boolean indicating if input was a single file.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.check_protected_files">
<span class="sig-name descname"><span class="pre">check_protected_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">created_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.check_protected_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.check_protected_files" title="Link to this definition"></a></dt>
<dd><p>Check whether a set of files associated to a session are protected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list</strong> (<em>list</em><em>, </em><em>str</em><em>, </em><em>pathlib.Path</em>) – A filepath (or list thereof) of ALF datasets to register to Alyx.</p></li>
<li><p><strong>created_by</strong> (<em>str</em>) – Name of Alyx user (defaults to whoever is logged in to ONE instance).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A status for each session whether any of the files specified are protected
datasets or not.If none of the datasets are protected, a response with status
200 is returned, if any of the files are protected a response with status
403 is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dicts, dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.register_files">
<span class="sig-name descname"><span class="pre">register_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">created_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repository</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_md5_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.register_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.register_files" title="Link to this definition"></a></dt>
<dd><p>Registers a set of files belonging to a session only on the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list</strong> (<em>list</em><em>, </em><em>str</em><em>, </em><em>pathlib.Path</em>) – A filepath (or list thereof) of ALF datasets to register to Alyx.</p></li>
<li><p><strong>versions</strong> (<em>str</em><em>, </em><em>list</em><em> of </em><em>str</em>) – Optional version tags.</p></li>
<li><p><strong>default</strong> (<em>bool</em>) – Whether to set as default revision (defaults to True).</p></li>
<li><p><strong>created_by</strong> (<em>str</em>) – Name of Alyx user (defaults to whoever is logged in to ONE instance).</p></li>
<li><p><strong>server_only</strong> (<em>bool</em>) – Will only create file records in the ‘online’ repositories and skips local repositories</p></li>
<li><p><strong>repository</strong> (<em>str</em>) – Name of the repository in Alyx to register to.</p></li>
<li><p><strong>exists</strong> (<em>bool</em>) – Whether the files exist on the repository (defaults to True).</p></li>
<li><p><strong>dry</strong> (<em>bool</em>) – When true returns POST data for registration endpoint without submitting the data.</p></li>
<li><p><strong>max_md5_size</strong> (<em>int</em>) – Maximum file in bytes to compute md5 sum (always compute if None).</p></li>
<li><p><strong>exists</strong> – Whether files exist in the repository. May be set to False when registering files
before copying to the repository.</p></li>
<li><p><strong>kwargs</strong> – Extra arguments directly passed as REST request data to /register-files endpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of newly created Alyx dataset records or the registration data if dry. If
a single file is passed in, a single dict is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of dicts, dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The registered files may be automatically moved to new revision folders if they are
protected on Alyx, therefore it’s important to check the relative paths of the output.</p></li>
<li><p>Protected datasets are not checked in dry mode.</p></li>
<li><p>In most circumstances a new revision will be added automatically, however if this fails
a 403 HTTP status may be returned.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requests.exceptions.HTTPError</strong> – Submitted data not valid (400 status code)
    Server side database error (500 status code)
    Revision protected (403 status code)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.register_water_administration">
<span class="sig-name descname"><span class="pre">register_water_administration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.register_water_administration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.register_water_administration" title="Link to this definition"></a></dt>
<dd><p>Register a water administration to Alyx for a given subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject</strong> (<em>str</em>) – A subject nickname that exists on Alyx</p></li>
<li><p><strong>volume</strong> (<em>float</em>) – The total volume administrated in ml</p></li>
<li><p><strong>date_time</strong> (<em>str</em><em>, </em><em>datetime.datetime</em><em>, </em><em>datetime.date</em>) – The time of administration.  If None, the current time is used.</p></li>
<li><p><strong>water_type</strong> (<em>str</em>) – A water type that exists in Alyx; default is ‘Water’</p></li>
<li><p><strong>user</strong> (<em>str</em>) – The user who administrated the water.  Currently logged-in user is the default.</p></li>
<li><p><strong>session</strong> (<em>str</em><em>, </em><em>UUID</em><em>, </em><em>pathlib.Path</em><em>, </em><em>dict</em>) – An optional experiment ID to associate</p></li>
<li><p><strong>adlib</strong> (<em>bool</em>) – If true, indicates that the subject was given water ad libitum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A water administration record</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="one.alf.exceptions.html#one.alf.exceptions.AlyxSubjectNotFound" title="one.alf.exceptions.AlyxSubjectNotFound"><strong>one.alf.exceptions.AlyxSubjectNotFound</strong></a> – Subject does not exist on Alyx</p></li>
<li><p><a class="reference internal" href="one.alf.exceptions.html#one.alf.exceptions.ALFError" title="one.alf.exceptions.ALFError"><strong>one.alf.exceptions.ALFError</strong></a> – User does not exist on Alyx</p></li>
<li><p><strong>ValueError</strong> – date_time is not a valid ISO date time or session ID is not valid</p></li>
<li><p><strong>requests.exceptions.HTTPError</strong> – Failed to connect to database, or submitted data not valid (500)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="one.registration.RegistrationClient.register_weight">
<span class="sig-name descname"><span class="pre">register_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/one/registration.html#RegistrationClient.register_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#one.registration.RegistrationClient.register_weight" title="Link to this definition"></a></dt>
<dd><p>Register a subject weight to Alyx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject</strong> (<em>str</em>) – A subject nickname that exists on Alyx.</p></li>
<li><p><strong>weight</strong> (<em>float</em>) – The subject weight in grams.</p></li>
<li><p><strong>date_time</strong> (<em>str</em><em>, </em><em>datetime.datetime</em><em>, </em><em>datetime.date</em>) – The time of weighing.  If None, the current time is used.</p></li>
<li><p><strong>user</strong> (<em>str</em>) – The user who performed the weighing.  Currently logged-in user is the default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An Alyx weight record</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="one.alf.exceptions.html#one.alf.exceptions.AlyxSubjectNotFound" title="one.alf.exceptions.AlyxSubjectNotFound"><strong>one.alf.exceptions.AlyxSubjectNotFound</strong></a> – Subject does not exist on Alyx</p></li>
<li><p><a class="reference internal" href="one.alf.exceptions.html#one.alf.exceptions.ALFError" title="one.alf.exceptions.ALFError"><strong>one.alf.exceptions.ALFError</strong></a> – User does not exist on Alyx</p></li>
<li><p><strong>ValueError</strong> – date_time is not a valid ISO date time or weight &lt; 1e-4</p></li>
<li><p><strong>requests.exceptions.HTTPError</strong> – Failed to connect to database, or submitted data not valid (500)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="one.params.CACHE_DIR_DEFAULT.html" class="btn btn-neutral float-left" title="one.params.CACHE_DIR_DEFAULT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="one.remote.html" class="btn btn-neutral float-right" title="one.remote" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, International Brain Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>